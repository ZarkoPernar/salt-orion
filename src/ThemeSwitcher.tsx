import { Button } from "@salt-ds/core";
import { createContext, useContext } from "react";

export const defaultValue = {
  toggle: () => {},
  mode:
    window.matchMedia &&
    window.matchMedia("(prefers-color-scheme: dark)").matches
      ? "dark"
      : "light",
} as const;
export const ThemeSwitcherContext = createContext(defaultValue);

export const useThemeSwitcher = () => useContext(ThemeSwitcherContext);

export const ThemeSwitcher = () => {
  const { mode, toggle } = useThemeSwitcher();

  return (
    <Button variant="secondary" onClick={toggle}>
      {mode === "light" ? (
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 512 512"
          xmlSpace="preserve"
          width="1em"
          height="1em"
          aria-labelledby="sun-icon"
          fill="var(--button-text-color)"
        >
          <title id="sun-icon">sun</title>
          <path d="M420.518 273.86h33.011v-35.72h-33.011a164.17 164.17 0 0 0-13.124-48.925l66.686-38.499-17.86-30.934-66.734 38.529a166.9 166.9 0 0 0-35.795-35.795l16.541-28.651-30.934-17.86-16.513 28.602a164.17 164.17 0 0 0-48.925-13.124V14.496h-35.72v76.986a164.14 164.14 0 0 0-48.925 13.124l-16.513-28.602-30.934 17.86 16.541 28.651a166.9 166.9 0 0 0-35.795 35.795L55.78 119.781l-17.86 30.934 66.685 38.5a164.17 164.17 0 0 0-13.124 48.925H58.469v35.721H91.48a164.14 164.14 0 0 0 13.124 48.925l-66.685 38.5 17.86 30.934 66.734-38.529a166.9 166.9 0 0 0 35.795 35.795l-16.541 28.651 30.934 17.86 16.513-28.602a164.17 164.17 0 0 0 48.925 13.124v76.986h35.721v-76.986a164.17 164.17 0 0 0 48.925-13.124l16.513 28.602 30.934-17.86-16.541-28.651a166.9 166.9 0 0 0 35.795-35.795l66.734 38.529 17.86-30.934-66.685-38.5a164.213 164.213 0 0 0 13.123-48.926zM256 385.767c-71.553 0-129.766-58.213-129.766-129.766S184.447 126.235 256 126.235s129.766 58.213 129.766 129.766S327.553 385.767 256 385.767zM350.048 454.657l30.933-17.86 18.468 31.986-30.934 17.86zM475.065 238.141H512v35.721h-36.935zM350.05 57.361l18.468-31.985 30.934 17.86-18.468 31.985zM112.53 43.218l30.934-17.86 18.468 31.986-30.934 17.86zM0 238.141h36.935v35.721H0zM112.523 468.779l18.467-31.986 30.934 17.86-18.468 31.986z" />
        </svg>
      ) : (
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="1em"
          height="1em"
          viewBox="0 0 45.74 45.74"
          xmlSpace="preserve"
          aria-labelledby="moon-icon"
          fill="var(--button-text-color)"
        >
          <title id="moon-icon">moon</title>
          <path d="M12.2 15.267c0-3.322.896-6.43 2.448-9.113.376-.649-.191-1.451-.918-1.265C5.35 7.041-.711 14.961.067 24.179.803 32.88 7.835 39.982 16.53 40.796c6.033.565 11.517-1.811 15.221-5.848.5-.546.073-1.432-.666-1.401-.196.009-.395.013-.594.013-10.102 0-18.291-8.189-18.291-18.293zM23.144 5.6l.917 2.633 2.788.061a.373.373 0 0 1 .218.669l-2.221 1.687.805 2.669c.104.338-.279.614-.568.414l-2.292-1.59-2.29 1.59a.373.373 0 0 1-.569-.414l.805-2.669-2.221-1.687a.373.373 0 0 1 .218-.669l2.788-.061.918-2.633a.373.373 0 0 1 .704 0zM40.26 26.44l.881 2.53 2.679.057a.41.41 0 0 1 .24.737l-2.134 1.621.772 2.564c.111.371-.309.677-.627.454l-2.201-1.527-2.2 1.527a.41.41 0 0 1-.626-.454l.772-2.564-2.133-1.621a.41.41 0 0 1 .238-.737l2.679-.057.884-2.53a.411.411 0 0 1 .776 0zM39.926 8.098l1.325 3.799 4.021.086c.452.01.639.584.278.858l-3.204 2.434 1.162 3.853a.476.476 0 0 1-.729.529l-3.306-2.294-3.305 2.294a.477.477 0 0 1-.729-.529l1.161-3.853-3.205-2.434c-.358-.273-.172-.849.279-.858l4.022-.086 1.324-3.799a.48.48 0 0 1 .906 0z" />
        </svg>
      )}
    </Button>
  );
};
